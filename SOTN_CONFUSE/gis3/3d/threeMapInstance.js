(function(a){a.fn.threeMap=function(){var b=a.fn.GeoUtils.methods.getHeight();a("#g_map").css("height",b);a.fn.threeMap.methods.init()};a.fn.threeMap.methods={init:function(){var d=echarts.init(document.getElementById("g_map"));var c=a.fn.threeMap.methods.getChinaChart();var b=a("body").GeoUtils("get3dMapInstance",{chinaChart:c});d.setOption(b);a.fn.threeMap.methods.renderNationalData(d);a.fn.threeMap.methods.renderChinaData(c);window.onresize=function(){var e=a.fn.GeoUtils.methods.getHeight();a("#g_map").css("height",e);a.fn.GeoUtils.methods.getResize(c);a.fn.GeoUtils.methods.getResize(d)};a(".province").click(function(){a.fn.threeMap.methods.eventTrigger(d)});a(".colorChange").click(function(){a.fn.threeMap.methods.eventColor(c,d)});a("#g_map").click(function(){a.fn.threeMap.methods.eventMap(c,d)})},getChinaChart:function(){var c=document.createElement("canvas");var b=echarts.init(c,null,{width:4096,height:2048});b.setOption({geo:{map:"china",top:0,left:0,right:0,bottom:0,silent:false,boundingCoords:[[-180,90],[180,-90]],itemStyle:{normal:{areaColor:"rgba(0,0,152,0.5)",borderColor:"#032E29"}},emphasis:{itemStyle:{color:"blue"}}},series:[]});return b},renderChinaData:function(d){var c=d.getOption();var b=[];a.get("geoData.json",function(e){c.visualMap={left:"right",min:500,max:5000,inRange:{color:["#0FF5D8","#1a766c","#1a766c","#032E29"]},text:["High","Low"],calculable:true};b.push({type:"map",map:"china",top:0,left:0,right:0,bottom:0,roam:false,boundingCoords:[[-180,90],[180,-90]],itemStyle:{normal:{areaColor:"rgba(0,0,152,0.5)"},emphasis:{label:{show:true}}},emphasis:{itemStyle:{color:"blue"}},data:e.region});c.series=b;d.setOption(c)})},renderNationalData:function(d){var c=d.getOption();var b=[];a.get("geoData.json",function(e){b.push({type:"lines3D",name:"lines3D",lineStyle:{width:1,color:"red",opacity:0.8},data:e.lines},{type:"scatter3D",name:"scatter3D",coordinateSystem:"globe",symbol:"circle",symbolSize:"5",itemStyle:{color:"blue",opacity:0.9},data:e.spots},{type:"lines3D",name:"王宁测试",effect:{show:true,trailWidth:2,trailLength:0.15,trailOpacity:1,trailColor:"#FBFCF9"},lineStyle:{width:2,color:"#29676F",opacity:0.9},blendMode:"lighter",data:[{coords:[[116.4136103013,39.9110666857],[-95.639302,37.266899]],lineStyle:{color:"#B33341"}},{coords:[[101.4038,36.8207],[-2.401801,30.95309]],lineStyle:{color:"#94BD68"}},{coords:[[106.6992,26.7682],[133.003999,-26.013866]],lineStyle:{color:"#388283"}},{coords:[[91.1865,30.1465],[17.326883,-23.866826]],lineStyle:{color:"#94BD68"}},{coords:[[102.9199,25.4663],[97.393614,-68.480939]],lineStyle:{color:"#B33341"}}]},{type:"scatter3D",name:"scatter3D2",coordinateSystem:"globe",symbol:"circle",symbolSize:"5",itemStyle:{color:"blue",opacity:0.9},label:{show:true,formatter:"{b}"},data:[{name:"北京",value:[116.4136103013,39.9110666857]},{name:"美国",value:[-95.639302,37.266899]},{name:"青海",value:[101.4038,36.8207]},{name:"阿尔及利亚",value:[-2.401801,30.95309]},{name:"贵州",value:[106.6992,26.7682]},{name:"澳大利亚",value:[134.247186,-25.479252]},{name:"西藏",value:[91.1865,30.1465]},{name:"纳米比亚",value:[17.326883,-23.866826]},{name:"云南",value:[102.9199,25.4663]},{name:"南极洲",value:[97.393614,-68.480939]}]});c.series=b;d.setOption(c)})},eventTrigger:function(c){var b=c.getOption();if(b.globe[0].viewControl.autoRotate){b.globe[0].viewControl.distance=100;b.globe[0].viewControl.autoRotate=false}else{b.globe[0].viewControl.distance=200;b.globe[0].viewControl.autoRotate=true}c.setOption(b)},eventColor:function(e,d){var b=e.getOption();if(b.visualMap[0].inRange.color.length==3){var c=d.getOption();b.visualMap[0]={left:"right",min:500,max:5000,inRange:{color:["#74B7E0","#4575b4","#2791CB","#0A24A5"]},text:["High","Low"],calculable:true};e.setOption(b);if(c.globe[0].viewControl.autoRotate){c.globe[0].viewControl.distance=100;c.globe[0].viewControl.autoRotate=false;d.setOption(c)}else{if(c.globe[0].viewControl.distance!=100){c.globe[0].viewControl.distance=200;c.globe[0].viewControl.autoRotate=true;d.setOption(c)}}}else{a.fn.threeMap.methods.eventTrigger(d)}},eventMap:function(e,d){var b=e.getOption();var c=d.getOption();if(!c.globe[0].viewControl.autoRotate){if(b.visualMap[0].inRange.color.length==4){b.visualMap[0]={left:"right",min:500,max:5000,inRange:{color:["#74B7E0","#74B7E0","#74B7E0"]},text:["High","Low"],calculable:true}}c.globe[0].viewControl.distance=200;c.globe[0].viewControl.autoRotate=true;d.setOption(c)}}}})(jQuery);