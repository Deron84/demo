<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>大屏3d地图</title>
    <script src="../../config/global.js"></script>
    <script src="../../lib/jquery-1.12.4.min.js"></script>
    <script src="../../lib/echarts4/echarts.js"></script>
    <script src="../../lib/echarts-gl/echarts_gl.js"></script>
    <script src="../../geodata/china.js"></script>
    <script src="../../inspur/GeoUtils.js"></script>
    <script src="../../inspur/frame/mapConfig.js"></script>
    <script src="threeMapInstance.js"></script>
    <style>
        *{margin: 0;padding: 0}
    </style>



</head>
<body>
<div id="g_map" style="width:100%;height:760px;"></div>
<div id="mapClick" style="width: 110px;height: 40px;line-height:40px;position: absolute;z-index: 999999;top: 155px;right: 60px;background: #ff2d51;font-size: 12px;text-align: center;border-radius: 15px">点击查看中国地区</div>

<script>
    $("body").threeMap({});
</script>
<!--<script type="text/javascript">
    var e_map = echarts.init(document.getElementById("g_map"));

    $.get('http://localhost:63342/SOTN/geodata/flights.json',function(data){
        $.get('../../geodata/world11.json',function(mapJson) {
            console.error('mapJson', mapJson);
            var datas = [];
            $.each(mapJson.features, function (index, item) {
                var row = {};
                datas.push("1");
            });
            echarts.registerMap('world', mapJson);
            var airports = data.airports.map(function (item) {
                return {
                    coord: [item[3], item[4]]
                }
            });
            function getAirportCoord(idx) {
                return [data.airports[idx][3], data.airports[idx][4]];
            }

            // Route: [airlineIndex, sourceAirportIndex, destinationAirportIndex]
            var routesGroupByAirline = {};
            data.routes.forEach(function (route) {
                var airline = data.airlines[route[0]];
                var airlineName = airline[0];
                if (!routesGroupByAirline[airlineName]) {
                    routesGroupByAirline[airlineName] = [];
                }
                routesGroupByAirline[airlineName].push(route);
            });

            var pointsData = [];
            data.routes.forEach(function (airline) {
                pointsData.push(getAirportCoord(airline[1]));
                pointsData.push(getAirportCoord(airline[2]));
            });

            var series = [];
            var series = data.airlines.map(function (airline) {
                var airlineName = airline[0];
                var routes = routesGroupByAirline[airlineName];

                if (!routes) {
                    return null;
                }
                return {
                    type: 'lines3D',
                    name: airlineName,

                    effect: {
                        show: true,
                        trailWidth: 2,
                        trailLength: 0.15,
                        trailOpacity: 1,
                        trailColor: 'rgb(30, 30, 60)'
                    },

                    lineStyle: {
                        width: 1,
                        color: 'rgb(50, 50, 150)',
                        // color: 'rgb(118, 233, 241)',
                        opacity: 0.1
                    },
                    blendMode: 'lighter',

                    data: routes.map(function (item) {
                        return [airports[item[1]].coord, airports[item[2]].coord];
                    })
                };
            }).filter(function (series) {
                return !!series;
            });

            series.push({
                type: 'scatter3D',
                coordinateSystem: 'globe',
                blendMode: 'lighter',
                symbolSize: 2,
                itemStyle: {
                    color: 'rgb(50, 50, 150)',
                    opacity: 0.2
                },
                data: pointsData
            });

            //中国境内:线数据
            var series1Data = [
                [[127.9688,45.368],[125.8154,44.2584]],
                [[125.8154,44.2584],[123.1238,42.1216]],
                [[123.1238,42.1216],[117.4219,39.4189]],
                [[117.4219,39.4189],[117.1582,36.8701]],
                [[117.1582,36.8701],[118.8062,31.9208]],
                [[118.8062,31.9208],[116.0046,28.6633]],
                [[116.0046,28.6633],[119.4543,25.9222]],
                [[119.4543,25.9222],[113.5107,23.2196]],
                [[113.5107,23.2196],[108.479,23.1152]],
                // 转折点
                [[108.479,23.1152],[106.6992,26.7682]],

                [[106.6992,26.7682],[102.9199,25.4663]],
                [[102.9199,25.4663],[91.1865,30.1465]],
                [[91.1865,30.1465],[87.9236,43.5883]],
                [[87.9236,43.5883],[101.4038,36.8207]],
                [[101.4038,36.8207],[106.3586,38.1775]],
                [[106.3586,38.1775],[111.4124,40.4901]],
                [[111.4124,40.4901],[116.4551,40.2539]],
                [[116.4551,40.2539],[117.4219,39.4189]],

                // 广西 海南 广东
                [[108.479,23.1152],[110.3893,19.8516]],
                [[110.3893,19.8516],[113.5107,23.2196]],
                //  西宁 昆明
                [[101.4038,36.8207],[102.9199,25.4663]],
                // 西宁 兰州 西安 太原 济南
                [[101.4038,36.8207],[103.5901,36.3043]],
                [[103.5901,36.3043],[109.1162,34.2004]],
                [[109.1162,34.2004],[112.3352,37.9413]],
                [[112.3352,37.9413],[117.1582,36.8701]],
                // 西安 重庆 贵阳
                [[109.1162,34.2004],[107.7539,30.1904]],
                [[107.7539,30.1904],[106.6992,26.7682]],
                // ['广州','长沙','武汉','郑州','太原','北京']
                [[113.5107,23.2196],[113.0823,28.2568]],
                [[113.0823,28.2568],[114.3896,30.6628]],
                [[114.3896,30.6628],[113.4668,34.6234]],
                [[113.4668,34.6234],[112.3352,37.9413]],
                [[112.3352,37.9413],[116.4551,40.2539]],
                //['南昌','武汉','西安','郑州','济南']
                [[116.0046,28.6633],[114.3896,30.6628]],
                [[114.3896,30.6628],[109.1162,34.2004]],
                [[109.1162,34.2004],[113.4668,34.6234]],
                [[113.4668,34.6234],[117.1582,36.8701]],
                // ['呼和浩特','太原','石家庄','北京']
                [[111.4124,40.4901],[112.3352,37.9413]],
                [[112.3352,37.9413],[114.4995,38.1006]],
                [[114.4995,38.1006],[116.4551,40.2539]]
            ];

            //点的数据
            var seriesData2 = [
                [127.9688,45.368],
                [125.8154,44.2584],
                [123.1238,42.1216],
                [117.4219,39.4189],
                [117.1582,36.8701],
                [118.8062,31.9208],
                [116.0046,28.6633],
                [119.4543,25.9222],
                [113.5107,23.2196],
                [108.479,23.1152],
                [91.1865,30.1465],
                [87.9236,43.5883],
                [101.4038,36.8207],
                [106.3586,38.1775],
                [111.4124,40.4901],
                [116.4551,40.2539],
                [117.4219,39.4189],
                [102.9199,25.4663],
                [106.6992,26.7682],
                [113.0823,28.2568],
                [109.1162,34.2004],
                [110.3893,19.8516],
                [114.3896,30.6628],
                [113.4668,34.6234],
                [112.3352,37.9413],
                [114.4995,38.1006]
            ];
            var series1 = [{
                // 线条
                type: 'lines3D',
                name: 'lines3D',
                lineStyle: {
                    width: 1,
                    color: 'red',
                    opacity: 0.8
                },
                data:series1Data
            },{
                // 小圆点
                type: 'scatter3D',
                name: 'scatter',
                coordinateSystem: 'globe',
                symbol: 'circle',
                symbolSize: '5',
                itemStyle: {
                    color: 'blue',
                    opacity: 0.9
                },
                data: seriesData2
            },{
                type: 'lines3D',
                name: '王宁测试',

                effect: {
                    show: true,
                    trailWidth: 3,
                    trailLength: 0.15,
                    trailOpacity: 1,
                    // trailColor: 'rgb(30, 30, 60)'
                    trailColor:'red'
                },

                lineStyle: {
                    width: 1,
                    //color: 'rgb(50, 50, 150)',
                    color: 'rgb(118, 233, 241)',
                    opacity: 0.1
                },
                blendMode: 'lighter',

                data: [[[116.4136103013,39.9110666857],[132.5390625000,-25.6415263731]],[[116.4136103013,39.9110666857],[-0.368333,51.874722]]]
            }];


            
            //创建贴图

            var canvas = document.createElement('canvas');
            var mapChart = echarts.init(canvas, null, {
                width: 4096, height: 2048
            });
            mapChart.setOption({
                series : [
                    {
                        type: 'map',
                        map: 'china',
                        top: 0, left: 0,
                        right: 0, bottom: 0,
                        //silent:true,//图形是否不响应和触发鼠标事件，默认为 false，即响应和触发鼠标事件。
                        boundingCoords: [[-180, 90], [180, -90]],
                        itemStyle:{
                            normal:{
                                areaColor:"rgba(0,0,152,0.5)"
                                //areaColor:'red'
                            }},
                        emphasis:{
                            itemStyle:{
                                color:'blue'
                            }
                        },
                        data:[
                            {
                                name:'山东',
                                value:999,
                                selected:true,
                                itemStyle:{
                                    areaColor:'blue'
                                }
                            }
                        ]
                    }
                ]
            });

            var option = $("body").GeoUtils('get3dMapInstance',{chinaChart:mapChart});
            option.series = series1;
            e_map.setOption(option);
            
            $("#g_map").click(function(){
                if(!option.globe.viewControl.autoRotate) {
                    option.globe.viewControl.distance = Global.mapGlobal.treeMapConfig.rotate.distance;
                    option.globe.viewControl.autoRotate = true;
                    e_map.setOption(option);
                }
            });
            // 点击按钮事件
            $("#mapClick").click(function(){
                if(option.globe.viewControl.autoRotate) {
                    option.globe.viewControl.distance = Global.mapGlobal.treeMapConfig.noRotate.distance;
                    option.globe.viewControl.targetCoord = Global.mapGlobal.treeMapConfig.noRotate.targetCoord;
                    option.globe.viewControl.autoRotate = false;
                } else {
                    option.globe.viewControl.distance = Global.mapGlobal.treeMapConfig.rotate.distance;
                    option.globe.viewControl.targetCoord = Global.mapGlobal.treeMapConfig.rotate.targetCoord;
                    option.globe.viewControl.autoRotate = true;
                }
                e_map.setOption(option);
            });
        });
    });


</script>-->
</body>
</html>